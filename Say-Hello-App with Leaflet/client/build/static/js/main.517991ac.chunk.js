(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{135:function(e,t,a){e.exports=a.p+"static/media/user_location.af70f583.svg"},136:function(e,t,a){e.exports=a.p+"static/media/message_location.26bb8e3b.svg"},143:function(e,t,a){e.exports=a(280)},152:function(e,t,a){},164:function(e,t){},166:function(e,t){},200:function(e,t){},201:function(e,t){},274:function(e,t,a){},280:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),o=a(29),i=a.n(o),r=(a(148),a(150),a(152),a(55)),c=a(131),l=a(132),u=a(133),m=a(141),g=a(134),h=a(142),d=a(9),p=a.n(d),f=a(40),v=a.n(f),E=a(283),b=a(284),M=a(282),y=a(285),w=a(15),S=a(135),j=a.n(S),x=a(136),k=a.n(x),O=(a(274),p.a.icon({iconUrl:j.a,iconSize:[42,82],iconAnchor:[21,82],popupAnchor:[-5,-50]})),z=p.a.icon({iconUrl:k.a,iconSize:[42,82],iconAnchor:[21,82],popupAnchor:[-5,-50]}),U=v.a.object().keys({name:v.a.string().invalid(null).regex(/^[a-zA-Z0-9]{1,30}/).required(),message:v.a.string().invalid(null).min(5).max(100).required()}),L="localhost"===window.location.hostname?"http://localhost:5000/api/v1/messages":"production-url-here",C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(s)))).state={location:{lat:0,lng:0},haveUsersLocation:!1,zoom:2,userMessage:{name:"",message:""},sendingMessage:!1,sentMessage:!1,messages:[]},a.formIsValid=function(){var e={name:a.state.userMessage.name,message:a.state.userMessage.message};return!(v.a.validate(e,U).error||!a.state.haveUsersLocation)},a.formSubmitted=function(e){a.setState({sendingMessage:!0}),e.preventDefault(),a.formIsValid()&&fetch(L,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:a.state.userMessage.name,message:a.state.userMessage.message,latitude:a.state.location.lat,longitude:a.state.location.lng})}).then(function(e){return e.json()}).then(function(e){console.log(e),setTimeout(function(){a.setState({sendingMessage:!1,sentMessage:!0})},2e3)})},a.valueChanged=function(e){var t=e.target,n=t.name,s=t.value;a.setState(function(e){return{userMessage:Object(c.a)({},e.userMessage,Object(r.a)({},n,s))}})},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(L).then(function(e){return e.json()}).then(function(t){var a={};t=t.reduce(function(e,t){var n="".concat(t.latitude.toFixed(4)).concat(t.longitude.toFixed(4));return a[n]?(a[n].otherMessages=a[n].otherMessages||[],a[n].otherMessages.push(t)):(a[n]=t,e.push(t)),e},[]),e.setState({messages:t})}),navigator.geolocation.getCurrentPosition(function(t){e.setState({location:{lat:t.coords.latitude,lng:t.coords.longitude},haveUsersLocation:!0,zoom:13})},function(){console.log("Problem with getting location"),fetch("https://ipapi.co/json").then(function(e){return e.json()}).then(function(t){e.setState({location:{lat:t.latitude,lng:t.longitude},haveUsersLocation:!0,zoom:13})})})}},{key:"render",value:function(){var e=[this.state.location.lat,this.state.location.lng];return s.a.createElement("div",null,s.a.createElement(E.a,{className:"map",center:e,zoom:this.state.zoom},s.a.createElement(b.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.state.haveUsersLocation?s.a.createElement(M.a,{position:e,icon:O}):"",this.state.messages.map(function(e){return s.a.createElement(M.a,{key:e._id,position:[e.latitude,e.longitude],icon:z},s.a.createElement(y.a,null,s.a.createElement("p",null,s.a.createElement("em",null,e.name,": ")," ",e.message),e.otherMessages?e.otherMessages.map(function(e){return s.a.createElement("p",{key:e._id},s.a.createElement("em",null,e.name,": ")," ",e.message)}):""))})),s.a.createElement(w.b,{body:!0,className:"message-form"},s.a.createElement(w.d,null,"Welcome to GuestMap!"),s.a.createElement(w.c,null,"Leave a message with your location!"),s.a.createElement(w.c,null,"Thanks for stopping by!"),this.state.sendingMessage||this.state.sentMessage||!this.state.haveUsersLocation?this.state.sendingMessage||!this.state.haveUsersLocation?s.a.createElement("img",{alt:"",src:"https://digitalsynopsis.com/wp-content/uploads/2016/06/loading-animations-preloader-gifs-ui-ux-effects-18.gif",align:"center",width:"200px",height:"150px",margin:"auto",frameBorder:"0"}):s.a.createElement(w.c,null,"Thanks for leave Message!"):s.a.createElement(w.e,{onSubmit:this.formSubmitted},s.a.createElement(w.f,null,s.a.createElement(w.h,{for:"name"},"Name"),s.a.createElement(w.g,{onChange:this.valueChanged,type:"text",name:"name",id:"name",placeholder:"Enter your name"})),s.a.createElement(w.f,null,s.a.createElement(w.h,{for:"message"},"Message"),s.a.createElement(w.g,{onChange:this.valueChanged,type:"textarea",name:"message",id:"message",placeholder:"Enter your message"})),s.a.createElement(w.a,{type:"submit",disabled:!this.formIsValid(),color:"info"},"Send"))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[143,2,1]]]);
//# sourceMappingURL=main.517991ac.chunk.js.map